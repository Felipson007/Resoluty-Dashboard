(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[326],{43661:function(e,a,r){Promise.resolve().then(r.bind(r,90262)),Promise.resolve().then(r.bind(r,81523)),Promise.resolve().then(r.bind(r,70049))},90262:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return w}});var t=r(57437),n=r(2265),o=r(14780),i=r(78693),s=r(8516),l=r(46387),u=r(81425),c=r(38959),d=r(94013),m=r(35389),h=r(97494),f=r(97312),p=r(99098),y=r(99376);function w(){let[e,a]=(0,n.useState)(""),[r,w]=(0,n.useState)(""),[g,x]=(0,n.useState)(""),[b,v]=(0,n.useState)(!1),[j,Z]=(0,n.useState)(!1),{login:E,signup:C}=(0,p.a)(),S=(0,y.useRouter)();async function D(a){if(a.preventDefault(),!e||!r){x("Por favor, preencha todos os campos");return}try{x(""),v(!0),j?await C(e,r):await E(e,r),S.push("/dashboard")}catch(e){x(e.message||"Erro ao fazer login")}finally{v(!1)}}return(0,t.jsx)(o.Z,{component:"main",maxWidth:"sm",children:(0,t.jsx)(i.Z,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:(0,t.jsxs)(s.Z,{elevation:3,sx:{padding:4,display:"flex",flexDirection:"column",alignItems:"center",width:"100%",borderRadius:2},children:[(0,t.jsx)(l.Z,{component:"h1",variant:"h4",gutterBottom:!0,children:"\uD83D\uDE80 Resoluty Dashboard"}),(0,t.jsx)(l.Z,{variant:"body2",color:"text.secondary",align:"center",sx:{mb:3},children:j?"Crie sua conta para acessar o dashboard":"Fa\xe7a login para acessar o dashboard"}),g&&(0,t.jsx)(u.Z,{severity:"error",sx:{width:"100%",mb:2},children:g}),(0,t.jsxs)(i.Z,{component:"form",onSubmit:D,sx:{width:"100%"},children:[(0,t.jsx)(c.Z,{margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email",name:"email",autoComplete:"email",autoFocus:!0,value:e,onChange:e=>a(e.target.value),disabled:b}),(0,t.jsx)(c.Z,{margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Senha",type:"password",id:"password",autoComplete:"current-password",value:r,onChange:e=>w(e.target.value),disabled:b}),(0,t.jsx)(d.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2,py:1.5},disabled:b,children:b?(0,t.jsx)(m.Z,{size:24,color:"inherit"}):j?"Criar Conta":"Entrar"}),(0,t.jsx)(h.Z,{sx:{my:2}}),(0,t.jsx)(i.Z,{sx:{textAlign:"center"},children:(0,t.jsxs)(l.Z,{variant:"body2",children:[j?"J\xe1 tem uma conta?":"N\xe3o tem uma conta?",(0,t.jsx)(f.Z,{component:"button",variant:"body2",onClick:()=>{Z(!j),x("")},sx:{ml:1},children:j?"Fazer login":"Criar conta"})]})})]})]})})})}},99098:function(e,a,r){"use strict";r.d(a,{H:function(){return g},a:function(){return w}});var t=r(57437),n=r(2265),o=r(61466),i=r(738),s=r(5978);let l=(0,i.ZF)({apiKey:"AIzaSyDgFH74k2pOBWnYew00OMVBjnQYXcYzZdY",authDomain:"resolutydashboard.firebaseapp.com",projectId:"resolutydashboard",storageBucket:"resolutydashboard.firebasestorage.app",messagingSenderId:"948695454342",appId:"1:948695454342:web:f0f28af286ef883353f707"}),u=(0,o.v0)(l),c=(0,s.ad)(l);async function d(e){let a=(0,s.JU)(c,"users",e.uid),r={uid:e.uid,email:e.email,displayName:e.displayName||e.email.split("@")[0],role:"member",department:"general",createdAt:(0,s.Bt)(),lastLogin:(0,s.Bt)(),isActive:!0};await (0,s.pl)(a,r,{merge:!0})}async function m(e,a,r){try{let t=(await (0,o.Xb)(u,e,a)).user;return await d({uid:t.uid,email:t.email,displayName:r||t.displayName}),console.log("Usu\xe1rio registrado e perfil Firestore criado:",t.uid),t}catch(e){throw console.error("Erro no registro:",e.message),e}}async function h(e,a){try{let r=(await (0,o.e5)(u,e,a)).user;return await d({uid:r.uid,email:r.email,displayName:r.displayName}),console.log("Usu\xe1rio logado:",r.uid),r}catch(e){throw console.error("Erro no login:",e.message),e}}async function f(e){try{let a=(0,s.JU)(c,"users",e),r=await (0,s.QT)(a);if(r.exists())return r.data();return null}catch(e){throw console.error("Erro ao buscar perfil do usu\xe1rio:",e),e}}async function p(e,a){try{let r=(0,s.hJ)(c,"users"),t=(0,s.IO)(r,(0,s.ar)("uid","==",e)),n=await (0,s.PL)(t);if(n.empty)throw Error("Documento com UID ".concat(e," n\xe3o encontrado"));let o=n.docs[0],i=(0,s.JU)(c,"users",o.id);await (0,s.r7)(i,{...a,lastLogin:new Date})}catch(e){throw console.error("Erro ao atualizar perfil do usu\xe1rio:",e),e}}let y=(0,n.createContext)(void 0);function w(){let e=(0,n.useContext)(y);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function g(e){let{children:a}=e,[r,i]=(0,n.useState)(null),[s,l]=(0,n.useState)(null),[c,d]=(0,n.useState)(!0);async function w(e,a){return await h(e,a)}async function g(e,a){return await m(e,a)}async function x(){await (0,o.w7)(u)}async function b(e){await (0,o.LS)(u,e)}async function v(e){r&&(await p(r.uid,e),l(a=>a?{...a,...e}:null))}return(0,n.useEffect)(()=>(0,o.Aj)(u,async e=>{if(i(e),e)try{let a=await f(e.uid);l(a)}catch(e){console.error("Erro ao carregar perfil do usu\xe1rio:",e),l(null)}else l(null);d(!1)}),[]),(0,t.jsx)(y.Provider,{value:{currentUser:r,userProfile:s,login:w,signup:g,logout:x,resetPassword:b,updateProfile:v,loading:c},children:!c&&a})}}},function(e){e.O(0,[609,210,545,538,708,231,971,117,744],function(){return e(e.s=43661)}),_N_E=e.O()}]);